{% extends 'base.html' %}
{% block content %}

<div class="row">
  <div class="col-sm-7">
    <h1>Custom <span>Date</span>Picker</h1>
    <div class="date-picker">
      <div class="selected-date"></div>

      <div class="dates">
        <div class="month">
          <div class="arrows prev-mth">&lt</div>
          <div class="mth"></div>
          <div class="arrows next-mth">&gt</div>
        </div>
        <div class="days">
        </div>
      </div>
    </div>
  </div> 
  <div class="col-sm-5">
    <h1>Habits List <a href="{% url 'habit_add' %}"><button type="button" class="btn btn-success float-right" style="margin:.5rem">Add Habit</button></a> </h1>

    {% for habit in habits %}
      <div class="card">
        <div class="card-content">
          <span class="card-title">Name: {{ habit.name }}</span>
          <p>Description: {{ habit.description }}</p>
          {% if habit.good == True %} 
            <p>Good Habit</p>
          {% else %}
            <p>Bad Habit</p>
          {% endif %}
          {% if request.user == habit.user %}
              <a href="{% url 'habit_update' habit.id%}"><button type="button" class="btn btn-info float-right" style="margin:.5rem">Update Habit</button></a>
              <a href="{% url 'habit_delete' habit.id%}"><button type="button" class="btn btn-danger float-right" style="margin:.5rem">Delete Habit</button></a>
          {% endif %}
        </div>
      </div>
    {% endfor %}
  </div>
</div>


<script type="text/javascript">
	$(document).ready(function() {
    const date_picker_element = document.querySelector('.date-picker');
    const selected_date_element = document.querySelector('.date-picker .selected-date');
    const dates_element = document.querySelector('.date-picker .dates');
    const mth_element = document.querySelector('.date-picker .dates .month .mth');
    const next_mth_element = document.querySelector('.date-picker .dates .month .next-mth');
    const prev_mth_element = document.querySelector('.date-picker .dates .month .prev-mth');

    const days_element = document.querySelector('.date-picker .dates .days')
    const months =  ["January","February","March","April","May","June","July",
            "August","September","October","November","December"];

    let date = new Date();
    let day = date.getDate();
    let month = date.getMonth();
    let year = date.getFullYear();

    let selectedDate = date;
    let selectedDay = day;
    let selectedMonth = month;
    let selectedYear = year;

    mth_element.textContent = months[month] + ' ' + year;



    //EVENT LISTENERS
    date_picker_element.addEventListener('click', toggleDatePicker);
    next_mth_element.addEventListener('click', goToNextMonth);
    prev_mth_element.addEventListener('click', goToPrevMonth);

    //FUNCTIONS
    function toggleDatePicker(e) {
      if(!checkEventPathForClass(e.composedPath(), 'dates')){
        dates_element.classList.toggle('active')
      }
    }

    function goToNextMonth(e) {
      month++;
      if(month > 11){
        month = 0;
        year++;
      }
      mth_element.textContent = months[month] + ' ' + year;
    }

    function goToNextMonth(e) {
      month--
      if(month < 0){
        month = 11;
        year--;
      }
      mth_element.textContent = months[month] + ' ' + year;
    }
    

    //HELPER FUNCTIONS 
    function checkEventPathForClass(path, selector) {
      for(let i = 0; i < path.length ; i++){
        if(path[i].classList && path[i].classList.contains(selector)){
          return true;
        }
      }
      return false;
    }

	});
</script>

{% endblock %}